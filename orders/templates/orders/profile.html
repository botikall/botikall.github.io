<!-- orders/profile.html -->
{% extends 'orders/base.html' %}

{% block title %}–ö–∞–±—ñ–Ω–µ—Ç{% endblock %}
{% load static %}
{% block content %}
   <div class="container" style="margin-top: 80px; text-align: center;">
        <h2>–ö–∞–±—ñ–Ω–µ—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</h2>
        <div class="dashboard">
            <!-- –ë–ª–æ–∫ –ø—Ä–æ—Ñ—ñ–ª—é (30%) -->
            <div class="profile-container">
                <div class="profile-header">
                    <h3 class="profile-text">–í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å:</h3>
                    <div class="user-info" style="gap: 25px">
                        <span class="username">{{ user.username }}</span>
                        <form action="{% url 'logout' %}" method="post" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" style="background: none; border: none; padding: 0;">
                                <img src="{% static 'orders/images/exit.png' %}" alt="–í–∏–π—Ç–∏" class="logout-icon">
                            </button>
                        </form>
                    </div>
                </div>

                <!-- –ü–æ–ª—è –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é -->
                <form method="post" id="user-details-form">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <div class="form-buttons">
                        <button type="submit" id="save-button" class="btn-submit disabled" disabled style="font-size: 14px;">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                        <a href="{% url 'change_password' %}" class="btn-submit" style="font-size: 14px;">–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å</a>
                    </div>
                </form>
            </div>

            <!-- –ë–ª–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω—å (60%) -->
            <div class="orders-container">
                <h3>–Ü—Å—Ç–æ—Ä—ñ—è –≤–∞—à–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
                {% if orders %}
                <table class="cart-table">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞</th>
                            <th>–î–µ—Ç–∞–ª—ñ</th>
                            <th>–î–æ—Å—Ç–∞–≤–∫–∞</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–û—Ü—ñ–Ω–∫–∞</th>
                            <th>–î—ñ—ó</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr class="order-row {% if forloop.counter > 4 %}hidden{% endif %}">
                            <td>{{ order.created_at }}</td>
                            <td>{{ order.total_price }} –≥—Ä–Ω</td>
                            <td>
                                <ul>
                                    {% for item in order.items.all %}
                                    <li>{{ item.product.name }} - {{ item.quantity }} —à—Ç. –∑–∞ {{ item.price }} –≥—Ä–Ω</li>
                                    {% endfor %}
                                </ul>
                            </td>
                            <td>{{ order.delivery_type|title }}
                                {% if order.delivery_type == 'courier' %}
                                    <br>–ê–¥—Ä–µ—Å–∞: {{ order.delivery_address|default:"–í–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è..." }}
                                {% endif %}
                            </td>
                            <td id="status-{{ order.id }}">{{ order.get_status_display }}</td>
                            <td>
                                {% if order.status == 'completed' %}
                                    {% if order.comment %}
                                        <span>–ü–æ—Å–ª—É–≥–∏ –≤–∂–µ –æ—Ü—ñ–Ω–µ–Ω–æ</span>
                                    {% else %}
                                        <button class="btn-submit" onclick="toggleReviewForm({{ order.id }})">–û—Ü—ñ–Ω–∏—Ç–∏ –ø–æ—Å–ª—É–≥–∏</button>
                                        <div id="review-form-{{ order.id }}" class="review-form hidden">
                                            <form method="post" onsubmit="submitReview(event, {{ order.id }})">
                                                {% csrf_token %}
                                                <input type="hidden" name="order_id" value="{{ order.id }}">
                                                <label for="rating">–û—Ü—ñ–Ω–∫–∞:</label>
                                                <div class="star-rating" data-order-id="{{ order.id }}">
                                                    <span class="star" data-value="5">‚òÖ</span>
                                                    <span class="star" data-value="4">‚òÖ</span>
                                                    <span class="star" data-value="3">‚òÖ</span>
                                                    <span class="star" data-value="2">‚òÖ</span>
                                                    <span class="star" data-value="1">‚òÖ</span>
                                                </div>
                                                <input type="hidden" name="rating" id="rating-input-{{ order.id }}" required>
                                                <label for="text">–ö–æ–º–µ–Ω—Ç–∞—Ä:</label>
                                                <textarea name="text" id="comment-text-{{ order.id }}" required></textarea>
                                                <button type="submit" class="btn-submit">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                                            </form>
                                        </div>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td>
                                {% if order.status != 'canceled' and order.status != 'completed' %}
                                    <button class="btn-submit" onclick="cancelOrder({{ order.id }})">–í—ñ–¥–º–æ–≤–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <button id="load-more" class="more-btn" style="border: none; font-family: 'Waltograph'; cursor: pointer; display: inline-block;">–ë—ñ–ª—å—à–µ</button>
                <button id="hide-orders" class="more-btn" style="border: none; font-family: 'Waltograph'; cursor: pointer; display: none;">–ü—Ä–∏—Ö–æ–≤–∞—Ç–∏</button>
                {% else %}
                <p>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="container">
        <h2 style="text-align: center;">–¢–æ–ø –ø—Ä–æ–¥—É–∫—Ü—ñ—è</h2>

        <div class="swiper-wrapper-container">

            <div class="swiper-container">
                <div class="swiper-wrapper">
                    {% for product in products %}
                    <div class="swiper-slide">
                        <div class="product-card" style="display: flex; flex-direction: column; justify-content: space-between; align-items: center; min-height: 470px; border: 1px solid #ddd; border-radius: 10px; padding: 15px; text-align: center; background: #fff; box-shadow: 2px 2px 10px rgba(0,0,0,0.1);">
                            {% if product.image %}
                                <a href="{% url 'product_detail' product.id %}">
                                    <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px;">
                                </a>
                            {% endif %}
                            <h3 style="margin-top: 10px;">
                                <a href="{% url 'product_detail' product.id %}" style="text-decoration: none; color: inherit;">{{ product.name }}</a>
                            </h3>
                            <p>{{ product.description }}</p>
                            <p style="font-weight: bold;">–¶—ñ–Ω–∞: {{ product.price }} –≥—Ä–Ω</p>

                            <div style="width: 100%;">
                                {% if request.user.is_authenticated %}
                                    <form method="post" action="{% url 'add_to_cart' product.id %}" style="display: flex; flex-direction: column; align-items: center;">
                                        {% csrf_token %}
                                        <label for="quantity">–ö—ñ–ª—å–∫—ñ—Å—Ç—å:</label>
                                        <input type="number" name="quantity" id="quantity" value="1" min="1" style="width: 60px; text-align: center; margin-bottom: 10px;">
                                        <button type="submit" class="btn-submit">–î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞</button>
                                    </form>
                                {% else %}
                                    <a href="{% url 'login' %}?next={% url 'cart' %}" class="btn-submit">–î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

            </div>
            <div class="swiper-button-prev custom-prev"></div>
            <div class="swiper-button-next custom-next"></div>
        </div>

        <div class="more-comments" style="margin-top: 0px;">
            <a href="{% url 'product_list' %}" class="more-btn">–ë—ñ–ª—å—à–µ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó</a>
        </div>
    </div>
<style>
    /* –û–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è Swiper */
.swiper-wrapper-container {
    position: relative; /* –©–æ–± –∫–Ω–æ–ø–∫–∏ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–ª–∏—Å—è –≤—ñ–¥–Ω–æ—Å–Ω–æ –Ω–µ—ó */
    max-width: 1500px;
    margin: 0 auto;
}
 /* –°—Ç–∏–ª—ñ Swiper */
.swiper-container {
    overflow: hidden;
    padding: 20px;
    position: relative;
    max-width: 1280px;
    margin: 0 auto;
    padding: 20px 0;
}


.swiper-wrapper {
    display: flex;
    align-items: stretch; /* –í–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –ø–æ –≤–∏—Å–æ—Ç—ñ */
}

.swiper-slide {
    background: none !important; /* –ó–∞–±–∏—Ä–∞—î –±—ñ–ª–∏–π —Ñ–æ–Ω */
    padding: 0 !important;
    display: flex;
    height: auto; /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤–∏—Å–æ—Ç–∞ */
    align-items: stretch; /* –í–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –≤–∏—Å–æ—Ç–∏ –≤—Å—ñ—Ö –∫–∞—Ä—Ç–æ–∫ */
}

/* –§—ñ–∫—Å–∞—Ü—ñ—è –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–ª–∞–π–¥—ñ–≤ */
.swiper-button-prev,
.swiper-button-next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 45px;
    background: #f6cece; /* –ù–û–í–ò–ô –ö–û–õ–Ü–† */
    color: white;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 9;
}

/* –ó–º–µ–Ω—à–µ–Ω–æ –≤—ñ–¥—Å—Ç–∞–Ω—å –¥–æ –∫—Ä–∞—ó–≤ */
.swiper-button-prev {
    left: -60px;
}

.swiper-button-next {
    right: -60px;
}

/* –î–æ–¥–∞—Ç–∫–æ–≤–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö */
@media (max-width: 768px) {
    .swiper-button-prev {
        left: 5px;
    }
    .swiper-button-next {
        right: 5px;
    }
}

/* –°—Ç–∏–ª—ñ –¥–ª—è –∑—ñ—Ä–æ—á–æ–∫ */
.star-rating {
    display: flex;
    flex-direction: row-reverse; /* –†–µ–≤–µ—Ä—Å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ hover */
    justify-content: center;
    gap: 5px;
}

.star {
    font-size: 20px;
    cursor: pointer;
    color: #ccc;
    transition: color 0.3s ease-in-out, transform 0.2s ease-in-out;
    user-select: none;
}




/* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ –∑–º—ñ–Ω—é—î–º–æ –∫–æ–ª—ñ—Ä –ø–æ—Ç–æ—á–Ω–æ—ó –∑—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—ñ—Ö –ª—ñ–≤–æ—Ä—É—á */
.star:hover,
.star:hover ~ .star {
    color: pink;
    transform: scale(1.1);
}

/* –î–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö (–≤–∏–±—Ä–∞–Ω–∏—Ö) –∑—ñ—Ä–æ–∫ */
.star.selected,
.star.selected ~ .star {
    color: pink;
}

.profile-container {
    width: 30%;
    padding: 25px;
    background: #f8f9fa;
    border-radius: 10px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
}


.profile-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 20px;
}

.profile-text {
    margin: 0;
    font-size: 1.4em;
    font-weight: bold;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 15px;
}


.username {
    font-size: 1.2em;
    font-weight: bold;
}

/* –°—Ç–∏–ª—ñ —Ñ–æ—Ä–º–∏ */
#user-details-form {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 20px;
    border-radius: 8px;
}

/* –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –ø–æ–ª—è —Ñ–æ—Ä–º–∏ */
#user-details-form label {
    font-weight: bold;
    font-style: italic;
    display: block;
    margin-bottom: 5px;
}

#user-details-form input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 1em;
}

.logout-form {
    margin: 0;
}

.logout-button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}

.logout-icon {
    width: 25px;
    height: 25px;
    transition: transform 0.2s;
}

.logout-icon:hover {
    transform: scale(1.1);
}

.dashboard {
    gap: 20px;
    max-width: 1280px;
    display: flex;
    justify-content: space-between;
    align-items: stretch; /* –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –±–ª–æ–∫–∏ –ø–æ –≤–∏—Å–æ—Ç—ñ */
    margin-top: 20px;
}

.orders-container {
    width: 65%;
    max-height: 700px;
    overflow-y: auto;
    overflow-x: hidden;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    position: relative; /* –î–æ–¥–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω–µ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è */
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ */
.review-form {
    max-height: none; /* –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –æ–±–º–µ–∂–µ–Ω–Ω—è */
    overflow: visible; /* –î–æ–∑–≤–æ–ª—è—î–º–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è */
    display: none; /* –•–æ–≤–∞—î–º–æ, –ø–æ–∫–∏ –Ω–µ –≤—ñ–¥–∫—Ä–∏—é—Ç—å */
    flex-direction: column;
    gap: 10px;
    background: #f8f9fa;
    padding: 10px;
    border-radius: 8px;
    position: absolute;
    z-index: 10;
    width: auto;
    max-width: 250px; /* –û–±–º–µ–∂–µ–Ω–Ω—è —à–∏—Ä–∏–Ω–∏, —â–æ–± –Ω–µ –≤–∏—Ö–æ–¥–∏–ª–æ –∑–∞ –º–µ–∂—ñ */
    left: 50%;
    transform: translateX(-50%);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

/* –ó–∞–±–µ–∑–ø–µ—á—É—î, —â–æ–± –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ñ–¥–≥—É–∫—ñ–≤ –±—É–≤ —É –º–µ–∂–∞—Ö –±–ª–æ–∫—É */
td {
    position: relative;
}

/* –ó—Ä–æ–±–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –±—ñ–ª—å—à —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—é —Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—é */
.cart-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: auto; /* –î–æ–∑–≤–æ–ª—è—î —Å—Ç–æ–≤–ø—Ü—è–º –ø—ñ–¥–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è */
}

.cart-table thead {
    position: sticky;
    top: 0;
    background: #f6cece;
    z-index: 8;
}

.cart-table th, .cart-table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
    white-space: normal; /* –î–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–Ω–æ—Å–∏ —Ç–µ–∫—Å—Ç—É */
}

.cart-table tbody tr {
    display: none; /* –•–æ–≤–∞—î–º–æ –≤—Å—ñ —Ä—è–¥–∫–∏ —Å–ø–æ—á–∞—Ç–∫—É */
}

.cart-table tbody tr:nth-child(-n+4) {
    display: table-row; /* –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à—ñ 4 —Ä—è–¥–∫–∏ */
}

/* –ü–æ–ª—ñ–ø—à–µ–Ω–Ω—è –≤–∏–≥–ª—è–¥—É –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
.cart-table tbody tr:hover {
    background: #f5f5f5;
}

</style>
<script>

    function submitReview(event, orderId) {
    event.preventDefault();  // –ó–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –æ–¥—Ä–∞–∑—É

    let form = event.target;
    let formData = new FormData(form);
    let csrfToken = form.querySelector("[name=csrfmiddlewaretoken]").value;

    fetch("{% url 'add_comment' %}", {
        method: "POST",
        body: formData,
        headers: {
            "X-CSRFToken": csrfToken
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();  // üîÑ –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        } else {
            alert("–ü–æ–º–∏–ª–∫–∞: " + data.error);
        }
    })
    .catch(error => console.error("–ü–æ–º–∏–ª–∫–∞:", error));
}

    var swiper = new Swiper(".swiper-container", {
        slidesPerView: 4, // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ 4 –ø—Ä–æ–¥—É–∫—Ç–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ
        spaceBetween: 20, // –í—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ —Å–ª–∞–π–¥–∞–º–∏
        loop: true, // –ó–∞—Ü–∏–∫–ª–µ–Ω–µ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è
        centeredSlides: false,
        navigation: {
            nextEl: ".custom-next",
            prevEl: ".custom-prev",
        },
        breakpoints: {
            1024: {
                slidesPerView: 4, // –î–ª—è –≤–µ–ª–∏–∫–∏—Ö –µ–∫—Ä–∞–Ω—ñ–≤
            },
            768: {
                slidesPerView: 2, // –î–ª—è –ø–ª–∞–Ω—à–µ—Ç—ñ–≤
            },
            480: {
                slidesPerView: 1, // –î–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö
            }
        }
    });




document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".star-rating").forEach(rating => {
        const stars = rating.querySelectorAll(".star");
        const ratingInput = document.getElementById(`rating-input-${rating.dataset.productId}`);

        stars.forEach(star => {
            star.addEventListener("click", function () {
                const value = parseInt(this.dataset.value);

                // –û—á–∏—â—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤–∏–±—ñ—Ä
                stars.forEach(s => s.classList.remove("selected"));

                // –î–æ–¥–∞—î–º–æ –∫–ª–∞—Å "selected" –¥–ª—è –≤—Å—ñ—Ö –∑—ñ—Ä–æ–∫ –¥–æ –≤–∏–±—Ä–∞–Ω–æ—ó –≤–∫–ª—é—á–Ω–æ
                stars.forEach(s => {
                    if (parseInt(s.dataset.value) <= value) {
                        s.classList.add("selected");
                    }
                });

                // –ó–∞–ø–∏—Å—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –ø–æ–ª–µ
                ratingInput.value = value;
            });
        });

        // –û—á–∏—â–µ–Ω–Ω—è –ø—ñ–¥—Å–≤—ñ—á–µ–Ω–∏—Ö –∑—ñ—Ä–æ–∫ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –æ—Ü—ñ–Ω–∫–∏
        rating.addEventListener("mouseleave", function () {
            const currentValue = parseInt(ratingInput.value) || 0;
            stars.forEach(star => star.classList.remove("selected"));

            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—É –æ—Ü—ñ–Ω–∫—É
            stars.forEach(star => {
                if (parseInt(star.dataset.value) <= currentValue) {
                    star.classList.add("selected");
                }
            });
        });
    });
});


     document.getElementById("load-more").addEventListener("click", function () {
        document.querySelectorAll(".order-row").forEach(row => row.style.display = "table-row");
        this.style.display = "none";
        document.getElementById("hide-orders").style.display = "inline-block";
    });

    document.getElementById("hide-orders").addEventListener("click", function () {
        document.querySelectorAll(".order-row").forEach((row, index) => {
            if (index >= 4) {
                row.style.display = "none";
            }
        });
        this.style.display = "none";
        document.getElementById("load-more").style.display = "inline-block";
    });

    function toggleReviewForm(orderId) {
        var form = document.getElementById("review-form-" + orderId);
        form.style.display = form.style.display === "none" ? "block" : "none";
    }

    function enableSaveButton() {
        var saveButton = document.getElementById("save-button");
        saveButton.classList.remove("disabled");
        saveButton.classList.add("enabled");
        saveButton.disabled = false;
    }

    document.addEventListener("DOMContentLoaded", function () {
        var formFields = document.querySelectorAll("#user-details-form input");
        formFields.forEach(function (field) {
            field.addEventListener("input", enableSaveButton);
        });
    });

    function cancelOrder(orderId) {
        fetch(`/orders/cancel/${orderId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById("status-" + orderId).innerText = "–°–∫–∞—Å–æ–≤–∞–Ω–∏–π";
                document.getElementById("cancel-btn-" + orderId).style.display = "none";
            } else {
                alert("–ü–æ–º–∏–ª–∫–∞: " + data.error);
            }
        })
        .catch(error => console.error('–ü–æ–º–∏–ª–∫–∞:', error));
    }
</script>
{% endblock %}
